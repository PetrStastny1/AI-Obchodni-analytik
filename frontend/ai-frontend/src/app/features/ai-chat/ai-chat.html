<div class="ai-full-wrapper">

  <!-- CHAT SCROLL BUBBLES -->
  <div class="messages" #messagesContainer>
    <ng-container *ngFor="let msg of messages">
      <div class="bubble" [ngClass]="{ 'user': msg.sender === 'user', 'ai': msg.sender === 'ai' }">

        <div *ngIf="msg.text" class="text">{{ msg.text }}</div>

        <table *ngIf="msg.table" class="result-table">
          <thead>
            <tr>
              <th *ngFor="let col of msg.table.columns">{{ col }}</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of msg.table.rows">
              <td *ngFor="let col of msg.table.columns">{{ row[col] }}</td>
            </tr>
          </tbody>
        </table>

      </div>
    </ng-container>

    <div class="bubble ai typing" *ngIf="typingText">{{ typingText }}</div>

    <div class="bubble ai typing-dots" *ngIf="loading && !typingText">
      <span class="dot"></span><span class="dot"></span><span class="dot"></span>
    </div>
  </div>

  <!-- === FIXED INPUT BAR === -->
  <div class="input-bar">
    <div class="input-wrap">

      <!-- ðŸ’¬ NOVÃ CHAT -->
      <button class="glass-circle new-chat" (click)="newChat()" title="NovÃ½ chat">ðŸ’¬</button>

      <input [(ngModel)]="question" (keyup.enter)="send()" placeholder="Zeptej se AI na trÅ¾by, produkty, trendy..." />

      <button class="glass-circle mic" [class.recording]="isRecording" (click)="toggleRecording()">ðŸŽ¤</button>

      <button class="glass-circle send" (click)="send()">âž¤</button>

    </div>
  </div>

</div>
